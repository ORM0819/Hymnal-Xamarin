<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SDA Hymnal - Cycle Songs</title>
</head>
<body>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const totalSongs = parseInt(localStorage.getItem('totalSongs'), 10) || 0;
            let currentIndex = parseInt(localStorage.getItem('currentIndex') || '0', 10);

            if (currentIndex >= totalSongs) {
                // Reset index and redirect to index.html
                localStorage.removeItem('currentIndex');
                window.location.href = 'index.html';
            } else {
                // Update currentIndex in localStorage and redirect to the next song
                localStorage.setItem('currentIndex', currentIndex);
                const imageUrls = JSON.parse(localStorage.getItem('imageUrls'));
                const titles = JSON.parse(localStorage.getItem('titles'));
                const numbers = JSON.parse(localStorage.getItem('numbers'));

                const nextSongUrl = `image.html?image=${encodeURIComponent(imageUrls[currentIndex])}&title=${encodeURIComponent(titles[currentIndex])}&number=${encodeURIComponent(numbers[currentIndex])}`;

                // Increment index
                currentIndex += 1;
                localStorage.setItem('currentIndex', currentIndex);

                // Redirect after 100 milliseconds
                setTimeout(() => {
                    window.location.href = nextSongUrl;
                }, 100);
            }
        });
    </script>
</body>
</html>
